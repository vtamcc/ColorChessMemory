{"version":3,"sources":["assets/ColorMemoryChess/scripts/MemoryChess_GamePlay.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,4EAA4E;AAC5E,mBAAmB;AACnB,sFAAsF;AACtF,8BAA8B;AAC9B,sFAAsF;;;;;;;;;;;;;;;;;;;;;AAEtF,2DAAsD;AACtD,uDAAkD;AAE5C,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAkD,wCAAY;IAA9D;QAAA,qEAqMC;QAlMG,aAAO,GAAc,IAAI,CAAC;QAE1B,cAAQ,GAAY,IAAI,CAAC;QAGzB,cAAQ,GAAY,IAAI,CAAC;QAGzB,aAAO,GAAc,IAAI,CAAC;QAI1B,kBAAY,GAAqB,EAAE,CAAC;QAGpC,mBAAa,GAAuB,EAAE,CAAC;QACvC,gBAAU,GAAG,CAAC,CAAC;QACf,eAAS,GAAG,EAAE,CAAC;QACf,iBAAW,GAAG,EAAE,CAAC;QACjB,aAAO,GAAG,KAAK,CAAC;QAChB,iBAAW,GAAG,KAAK,CAAC;;QA6KpB,iBAAiB;IACrB,CAAC;6BArMoB,oBAAoB;IAyBrC,wBAAwB;IAExB,qCAAM,GAAN;QACI,sBAAoB,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrC,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,OAAO,EAAE,CAAC;IAEnB,CAAC;IAGD,0CAAW,GAAX;QACI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,4BAAkB,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,4BAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YACpD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,4BAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YACpD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,4BAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YACpD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,4BAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;SACvD;QAED,IAAI,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QACpD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAErC,CAAC;IAED,sCAAO,GAAP;;QACI,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YAChD,IAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YAC9C,KAAyC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,EAA9E,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,QAAA,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,QAAA,CAA2C;SACnF;QACD,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;IAC/C,CAAC;IAED,sCAAO,GAAP;QACI,iCAAiC;QACjC,uCAAuC;QAEvC,6DAA6D;QAC7D,sCAAsC;QACtC,0DAA0D;QAC1D,oDAAoD;QACpD,6DAA6D;QAC7D,4CAA4C;QAC5C,4CAA4C;QAC5C,uDAAuD;QACvD,8DAA8D;QAC9D,sCAAsC;QACtC,2CAA2C;QAC3C,4CAA4C;QAE5C,QAAQ;QACR,IAAI;QACJ,IAAI,QAAQ,GAAG,CAAC,CAAC;QACjB,IAAI,WAAW,GAAG,EAAE,CAAC;QACrB,IAAI,MAAM,GAAG,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC;QAC3E,IAAI,MAAM,GAAG,CAAC,QAAQ,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC;QAE3E,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC5C,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC;YACnC,IAAI,GAAG,GAAG,CAAC,GAAG,QAAQ,CAAC;YAEvB,yEAAyE;YACzE,mCAAmC;YACnC,qCAAqC;YACrC,IAAI,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,0BAAgB,CAAC,CAAC;YACvE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,GAAG,MAAM,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC,CAAC;YACvD,IAAI,CAAC,GAAG,MAAM,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,WAAW,CAAC,CAAC;YACxD,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC5B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACrC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACrC;IACL,CAAC;IAED,wCAAS,GAAT;QACI,IAAI,IAAI,CAAC,OAAO,EAAE;YACd,OAAO;SACV;QACD,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QAChD,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC;QAChF,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC/B,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAC1C,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QACxB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QAGpB,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;IAG1C,CAAC;IAED,4CAAa,GAAb,UAAc,IAAI;QACd,IAAI,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC;QACvB,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;aACb,EAAE,CAAC,GAAG,EAAE,EAAC,CAAC,EAAE,EAAE,EAAE,CAAC;aACjB,KAAK,CAAC,GAAG,CAAC;aACV,EAAE,CAAC,GAAG,EAAE,EAAC,CAAC,EAAE,SAAS,EAAC,CAAC;aACvB,KAAK,EAAE,CAAC;IACb,CAAC;IAED,qDAAsB,GAAtB,UAAuB,IAAI,EAAE,WAAW;QAAxC,iBAaC;QAZG,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;QAClB,WAAW,CAAC,MAAM,GAAG,KAAK,CAAC;QAC3B,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;aACT,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC;aAC/C,IAAI,CAAC;YACF,KAAI,CAAC,YAAY,CAAC;gBACd,IAAI,CAAC,OAAO,EAAE,CAAC;YACnB,CAAC,EAAE,GAAG,CAAC,CAAA;QACX,CAAC,CAAC;aACD,KAAK,EAAE,CAAC;IACjB,CAAC;IAGD,oDAAqB,GAArB,UAAsB,IAAI,EAAE,WAAW;QAEnC,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,IAAI,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC;QACvB,IAAI,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC;QACvB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;QAClB,WAAW,CAAC,MAAM,GAAG,KAAK,CAAC;QAC3B,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;aACT,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC;aAC/C,KAAK,CAAC,GAAG,CAAC;aACV,IAAI,CAAC;YACF,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC;QAC9B,CAAC,CAAC;aACD,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,SAAS,EAAE,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC;aACnD,KAAK,EAAE,CAAC;IACjB,CAAC;IAED,2CAAY,GAAZ,UAAa,OAAO,EAAE,IAAI,EAAE,WAAW;QAEnC,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QAC1C,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,OAAO,EAAE;YAChC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YACrB,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YAC5C,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;gBACd,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aACnC;YAED,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;SAElD;aAAM;YACH,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACpB,IAAI,CAAC,qBAAqB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;SACjD;QAED,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,EAAE;YAC5B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YACpB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;SAEtB;QAID,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QAC1C,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;IAC1B,CAAC;IAGD,0CAAW,GAAX;QACI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACxB,CAAC;IAED,oCAAK,GAAL;IAEA,CAAC;;IAjMa,6BAAQ,GAAyB,IAAI,CAAC;IAEpD;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;yDACM;IAE1B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;0DACO;IAGzB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;0DACO;IAGzB;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;yDACM;IAI1B;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;8DACW;IAGpC;QADC,QAAQ,CAAC,EAAE,CAAC,aAAa,CAAC;+DACY;IAlBtB,oBAAoB;QADxC,OAAO;OACa,oBAAoB,CAqMxC;IAAD,2BAAC;CArMD,AAqMC,CArMiD,EAAE,CAAC,SAAS,GAqM7D;kBArMoB,oBAAoB","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport MemoryChess_Global from \"./MemoryChess_Global\";\nimport MemoryChess_Item from \"./MemoryChess_Item\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class MemoryChess_GamePlay extends cc.Component {\n    public static instance: MemoryChess_GamePlay = null;\n    @property(cc.Prefab)\n    prfItem: cc.Prefab = null;\n    @property(cc.Node)\n    nodeItem: cc.Node = null;\n\n    @property(cc.Node)\n    nodeDice: cc.Node = null;\n\n    @property(cc.Sprite)\n    spfDice: cc.Sprite = null;\n\n\n    @property(cc.SpriteFrame)\n    listSpfChess: cc.SpriteFrame[] = [];\n\n    @property(cc.AnimationClip)\n    listAnimation: cc.AnimationClip[] = [];\n    numCircles = 3;\n    listColor = [];\n    listIdColor = [];\n    isClick = false;\n    isClickItem = false;\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        MemoryChess_GamePlay.instance = this;\n        this.randomColor();\n        this.shuffle();\n        this.renItem();\n\n    }\n\n\n    randomColor() {\n        for (let i = 0; i < MemoryChess_Global.arrColor.length; i++) {\n            this.listColor.push(MemoryChess_Global.arrColor[i]);\n            this.listColor.push(MemoryChess_Global.arrColor[i]);\n            this.listColor.push(MemoryChess_Global.arrColor[i]);\n            this.listColor.push(MemoryChess_Global.arrColor[i]);\n        }\n\n        let ramdomIndex = Math.floor(Math.random() * 6) + 1;\n        this.listColor.push(ramdomIndex);\n\n    }\n\n    shuffle() {\n        for (let i = this.listColor.length - 1; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            [this.listColor[i], this.listColor[j]] = [this.listColor[j], this.listColor[i]];\n        }\n        console.log(\"list Color \", this.listColor);\n    }\n\n    renItem() {\n        // let arrRadius = [200, 120, 0];\n        // let numPiecesInCircles = [16, 8, 1];\n\n        // for (let circle = 0; circle < this.numCircles; circle++) {\n        //     let radius = arrRadius[circle];\n        //     let numPiecesInCircle = numPiecesInCircles[circle];\n        //     for (let i = 0; i < numPiecesInCircle; i++) {\n        //         let angle = (i / numPiecesInCircle) * Math.PI * 2;\n        //         let x = Math.cos(angle) * radius;\n        //         let y = Math.sin(angle) * radius;\n        //         let itemNode = cc.instantiate(this.prfItem);\n        //         let item = itemNode.getComponent(MemoryChess_Item);\n        //         itemNode.setPosition(x, y);\n        //         item.setData(this.listColor[i]);\n        //         this.nodeItem.addChild(itemNode);\n\n        //     }\n        // }\n        let gridSize = 5;\n        let cellSpacing = 35;\n        let startX = -(gridSize - 1) * (this.prfItem.data.width + cellSpacing) / 2;\n        let startY = (gridSize - 1) * (this.prfItem.data.height + cellSpacing) / 2;\n\n        for (let i = 0; i < this.listColor.length; i++) {\n            let row = Math.floor(i / gridSize);\n            let col = i % gridSize;\n\n            // let item = cc.instantiate(this.prfItem).getComponent(MemoryChess_Item)\n            // item.setData(this.listColor[i]);\n            // this.nodeItem.addChild(item.node);\n            let item = cc.instantiate(this.prfItem).getComponent(MemoryChess_Item);\n            item.setData(this.listColor[i]);\n            let x = startX + col * (item.node.width + cellSpacing);\n            let y = startY - row * (item.node.height + cellSpacing);\n            item.node.setPosition(x, y);\n            this.moveChessBack(item.sprItemBack);\n            this.nodeItem.addChild(item.node);\n        }\n    }\n\n    clickRoll() {\n        if (this.isClick) {\n            return;\n        }\n        let idColor = Math.floor(Math.random() * 6) + 1;\n        this.nodeDice.getComponent(cc.Animation).play(this.listAnimation[idColor].name);\n        this.listIdColor.push(idColor);\n        console.log(\"idColor \", this.listIdColor);\n        this.isClickItem = true;\n        this.isClick = true;\n\n\n        console.log('isClick ', this.isClick);\n\n\n    }\n\n    moveChessBack(node) {\n        let originalY = node.y;\n        cc.tween(node)\n        .to(0.5, {y: 68 })\n        .delay(0.5)\n        .to(0.5, {y: originalY})\n        .start();\n    }\n\n    moveToCenterAndDestroy(node, disableNode) {\n        let centerX = 0;\n        let centerY = 0;\n        node.zIndex = 100;\n        disableNode.active = false;\n        cc.tween(node)\n            .to(0.5, { x: centerX, y: centerY, scale: 1.5 })\n            .call(() => {\n                this.scheduleOnce(() => {\n                    node.destroy();\n                }, 0.5)\n            })\n            .start();\n    }\n\n\n    moveToCenterAndReturn(node, disableNode) {\n\n        let centerX = 0;\n        let centerY = 0;\n        let originalX = node.x;\n        let originalY = node.y;\n        node.zIndex = 100;\n        disableNode.active = false;\n        cc.tween(node)\n            .to(0.5, { x: centerX, y: centerY, scale: 1.5 })\n            .delay(0.5)\n            .call(() => {\n                disableNode.active = true;\n            })\n            .to(0.5, { x: originalX, y: originalY, scale: 1.0 })\n            .start();\n    }\n\n    checkIdColor(idColor, node, disableNode) {\n       \n        console.log(\"listColor \", this.listColor);\n        if (this.listIdColor[0] == idColor) {\n            console.log(\"dung \");\n            let index = this.listColor.indexOf(idColor);\n            if (index !== -1) {\n                this.listColor.splice(index, 1);\n            }\n\n            this.moveToCenterAndDestroy(node, disableNode);\n\n        } else {\n            console.log(\"Sai \");\n            this.moveToCenterAndReturn(node, disableNode);\n        }\n\n        if (this.listColor.length == 0) {\n            this.isClick = true;\n            console.log(\"Win\");\n          \n        }\n\n\n\n        console.log(\"listColor \", this.listColor);\n        this.listIdColor = [];\n    }\n\n    \n    onClickBack() {\n        this.node.destroy();\n    }\n\n    start() {\n\n    }\n\n    // update (dt) {}\n}\n"]}